name: API Tests with Newman

on:
 push:

 jobs:
   run-api-tests:
     runs-on: ubuntu-latest

     steps:
       - name: Checkout repository
         uses: actions/checkout@v4

       - name: Install Node.js
         uses: actions/setup-node@v4
         with:
           node-version: "18"

       - name: Install Newman + HTML reporter
         run: |
           npm install -g newman newman-reporter-htmlextra

       - name: Run Postman Tests with HTML report
         run: |
           mkdir -p newman
           newman run APITestingCopy.postman_collection.json \
             -e postman/environment.json \
             -r cli,htmlextra \
             --reporter-htmlextra-export newman/report.html

       - name: Upload HTML report
         uses: actions/upload-artifact@v4
         with:
           name: newman-html-report
           path: newman/report.html
         
